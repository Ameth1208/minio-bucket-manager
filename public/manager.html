<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atlas Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <script>
        if (localStorage.getItem('theme') === 'dark' || (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'], mono: ['JetBrains Mono', 'monospace'] },
                    colors: { dark: { 950: '#020617', 900: '#0f172a', 800: '#1e293b', 700: '#334155' } }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="icon" href="https://api.iconify.design/simple-icons:minio.svg?color=%23f43f5e">
    <link rel="stylesheet" href="css/style.css">
    <style>
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .dark ::-webkit-scrollbar-thumb { background: #334155; }
        .theme-transition { transition: background-color 0.2s, border-color 0.2s, color 0.2s; }
        .animate-fade-in { animation: fadeIn 0.2s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-[#fcfcfd] dark:bg-dark-950 text-slate-800 dark:text-slate-200 theme-transition min-h-screen flex flex-col font-sans">

    <!-- Navbar -->
    <nav class="bg-white dark:bg-dark-900 border-b border-slate-200 dark:border-dark-800 sticky top-0 z-40">
        <div class="container mx-auto px-4 md:px-6 py-3.5 flex justify-between items-center">
            <div class="flex items-center gap-2.5">
                <div class="bg-rose-500 p-2 rounded-xl text-white flex items-center justify-center">
                    <iconify-icon icon="ph:globe-hemisphere-west-duotone" width="22"></iconify-icon>
                </div>
                <div class="hidden sm:flex flex-col">
                    <span class="text-base font-bold dark:text-white leading-tight">Atlas</span>
                    <span class="text-[10px] font-semibold text-slate-400 uppercase tracking-wider">Manager</span>
                </div>
            </div>

            <div class="flex-grow max-w-md mx-4 relative hidden md:block">
                <iconify-icon icon="ph:magnifying-glass-bold" class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400" width="18"></iconify-icon>
                <input type="text" id="globalSearchInput" placeholder="Global search objects..." class="w-full bg-slate-100 dark:bg-dark-800 border-none rounded-xl pl-10 pr-4 py-2 text-sm focus:ring-2 focus:ring-rose-500/20 transition-all outline-none text-slate-700 dark:text-slate-200">
                <div id="searchResults" class="absolute top-full left-0 right-0 mt-2 bg-white dark:bg-dark-800 rounded-xl shadow-2xl border border-slate-200 dark:border-dark-700 hidden max-h-96 overflow-y-auto z-50 p-2"></div>
            </div>

            <div class="flex items-center gap-2 md:gap-5">
                <div id="langSelectorContainer"></div>
                <button id="themeToggle" class="p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-dark-800 transition-colors">
                    <iconify-icon icon="ph:moon-bold" class="dark:hidden" width="20"></iconify-icon>
                    <iconify-icon icon="ph:sun-bold" class="hidden dark:block text-yellow-400" width="20"></iconify-icon>
                </button>
                <button id="logoutBtn" class="text-xs font-bold uppercase tracking-wider hover:text-rose-500" data-i18n="logout">Logout</button>
            </div>
        </div>
    </nav>

    <main class="container mx-auto px-4 md:px-6 py-10 flex-grow max-w-6xl">
        <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center mb-8 gap-6">
            <div>
                <h1 class="text-3xl font-bold text-slate-900 dark:text-white mb-1" data-i18n="title">Storage Buckets</h1>
                <p class="text-slate-500 dark:text-slate-400 text-sm" data-i18n="subtitle">Manage visibility and lifecycle.</p>
            </div>
            <form id="createBucketForm" class="w-full lg:w-auto flex bg-white dark:bg-dark-900 rounded-xl border border-slate-200 dark:border-dark-800 p-1 focus-within:border-rose-500/50 shadow-sm gap-1">
                <select id="createProviderId" class="bg-slate-50 dark:bg-dark-800 text-slate-700 dark:text-slate-300 text-xs font-bold px-3 py-2 rounded-lg outline-none border-none hidden">
                </select>
                <input type="text" id="newBucketName" placeholder="bucket-name" required class="bg-transparent text-slate-900 dark:text-white w-full lg:w-48 px-4 py-2 focus:outline-none font-mono text-sm">
                <button type="submit" class="bg-rose-600 hover:bg-rose-700 text-white text-xs font-bold uppercase px-5 py-2 rounded-lg transition-all active:scale-95 shadow-lg shadow-rose-600/10" data-i18n="create">Create</button>
            </form>
        </div>

        <!-- Provider Filters -->
        <div id="filterContainer" class="flex flex-wrap items-center gap-2 mb-10">
        </div>

        <div id="loader" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"><div class="bg-white dark:bg-dark-900 h-40 rounded-xl border border-slate-100 dark:border-dark-800 animate-pulse"></div><div class="bg-white dark:bg-dark-900 h-40 rounded-xl border border-slate-100 dark:border-dark-800 animate-pulse"></div><div class="bg-white dark:bg-dark-900 h-40 rounded-xl border border-slate-100 dark:border-dark-800 animate-pulse"></div></div>
        <div id="bucketList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 hidden"></div>
        <div id="emptyState" class="hidden flex flex-col items-center justify-center py-24 text-center border border-dashed border-slate-200 dark:border-dark-800 rounded-3xl">
            <iconify-icon icon="ph:cube-transparent-thin" width="64" class="text-slate-300 dark:text-slate-700 mb-4"></iconify-icon>
            <h3 class="text-lg font-bold" data-i18n="emptyTitle">No buckets</h3>
        </div>
    </main>

    <!-- Modal Explorer -->
    <div id="explorerModal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm" onclick="window.app.closeExplorer()"></div>
        <div class="relative bg-white dark:bg-dark-900 w-full max-w-5xl rounded-xl shadow-2xl border border-slate-200 dark:border-dark-800 flex flex-col max-h-[85vh] overflow-hidden">
            <div class="p-5 border-b border-slate-100 dark:border-dark-800 flex justify-between items-center bg-slate-50/50 dark:bg-dark-800/50">
                <div class="flex items-center gap-3">
                    <div class="bg-indigo-500/10 dark:bg-indigo-500/20 aspect-square w-10 flex items-center justify-center rounded-xl text-indigo-600 dark:text-indigo-400">
                        <iconify-icon icon="ph:folder-open-bold" width="22"></iconify-icon>
                    </div>
                    <div class="flex flex-col">
                        <h3 class="text-lg font-bold text-slate-900 dark:text-white font-mono" id="explorerTitle">Files</h3>
                        <div class="flex items-center gap-1 text-xs text-slate-500 dark:text-slate-400 font-mono overflow-x-auto whitespace-nowrap">
                            <span class="cursor-pointer hover:text-indigo-500" onclick="window.app.navigateExplorer('')">root</span>
                            <span id="breadcrumbs"></span>
                        </div>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <button onclick="document.getElementById('fileUploadInput').click()" class="bg-rose-600 hover:bg-rose-700 text-white flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold shadow-lg shadow-rose-600/20 transition-all active:scale-95">
                        <iconify-icon icon="ph:upload-simple-bold" width="18"></iconify-icon>
                        <span class="hidden sm:inline">Upload</span>
                    </button>
                    <input type="file" id="fileUploadInput" multiple class="hidden" onchange="window.app.handleUpload(this.files)">
                    <button onclick="window.app.closeExplorer()" class="aspect-square w-10 flex items-center justify-center text-slate-400 hover:text-rose-500 transition-colors bg-slate-50 dark:bg-dark-800 rounded-xl border border-slate-200 dark:border-dark-700">
                        <iconify-icon icon="ph:x-bold" width="20"></iconify-icon>
                    </button>
                </div>
            </div>
            <div class="flex-grow overflow-y-auto p-4" id="fileList"></div>
            <div class="p-3 border-t border-slate-100 dark:border-dark-800 bg-white dark:bg-dark-900 flex justify-between items-center text-xs text-slate-400">
                <div class="flex gap-4">
                    <span data-i18n="readOnly">Secure Access</span>
                    <button id="bulkDeleteBtn" class="text-rose-500 font-bold hidden hover:underline" onclick="window.app.bulkDelete()">Delete Selected</button>
                </div>
                <span id="fileCount">0 items</span>
            </div>
        </div>
    </div>

    <!-- URL Expiry Modal -->
    <div id="urlModal" class="fixed inset-0 z-[70] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm" onclick="window.app.closeUrlModal()"></div>
        <div class="relative bg-white dark:bg-dark-900 w-full max-w-sm rounded-xl border border-slate-200 dark:border-dark-800 p-6 shadow-2xl">
            <h3 class="text-lg font-bold mb-4 dark:text-white">Share File</h3>
            <p class="text-xs text-slate-500 mb-4">Generate a temporary download link.</p>
            <label class="block text-[10px] font-bold uppercase tracking-wider text-slate-400 mb-2">Expiration Time</label>
            <select id="urlExpiry" class="w-full bg-slate-100 dark:bg-dark-800 border-none rounded-lg px-4 py-2.5 text-sm outline-none mb-6">
                <option value="60">1 Minute</option>
                <option value="3600" selected>1 Hour</option>
                <option value="86400">24 Hours</option>
                <option value="604800">7 Days</option>
            </select>
            <div class="flex gap-3">
                <button onclick="window.app.closeUrlModal()" class="flex-1 px-4 py-2 rounded-lg text-sm font-bold bg-slate-100 dark:bg-dark-800">Cancel</button>
                <button onclick="window.app.generateShareLink()" class="flex-1 px-4 py-2 rounded-lg text-sm font-bold bg-rose-600 text-white">Generate</button>
            </div>
        </div>
    </div>

    <!-- Preview Modal -->
    <div id="previewModal" class="fixed inset-0 z-[60] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/90 backdrop-blur-md" onclick="window.app.closePreview()"></div>
        <div class="relative w-full max-w-4xl max-h-[90vh] flex flex-col items-center">
            <div class="w-full flex justify-end mb-4 gap-4">
                <a id="previewDownloadBtn" href="#" target="_blank" class="text-white hover:text-indigo-400 flex items-center gap-2 text-sm font-bold bg-white/10 px-4 py-2 rounded-lg"><iconify-icon icon="ph:download-bold"></iconify-icon> Download</a>
                <button onclick="window.app.closePreview()" class="text-white hover:text-rose-500 bg-white/10 px-3 py-2 rounded-lg"><iconify-icon icon="ph:x-bold" width="20"></iconify-icon></button>
            </div>
            <div id="previewContent" class="rounded-xl overflow-hidden flex items-center justify-center w-full h-full"></div>
            <p id="previewName" class="text-slate-400 text-sm mt-4 font-mono"></p>
        </div>
    </div>

    <!-- Delete Modal -->
    <div id="deleteModal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-slate-900/50 backdrop-blur-sm"></div>
        <div class="relative bg-white dark:bg-dark-900 w-full max-w-sm rounded-xl border border-slate-200 dark:border-dark-800 p-8 shadow-2xl">
            <div class="bg-rose-100 dark:bg-rose-900/30 w-14 h-14 rounded-xl flex items-center justify-center text-rose-600 mb-6">
                <iconify-icon icon="ph:trash-bold" width="28"></iconify-icon>
            </div>
            <h3 class="text-xl font-bold mb-2 dark:text-white">Delete Item</h3>
            <p class="text-sm text-slate-500 dark:text-slate-400 mb-8">Confirm deletion?</p>
            <div class="flex gap-3">
                <button onclick="window.app.closeDeleteModal()" class="flex-1 px-4 py-2.5 rounded-lg font-bold text-sm bg-slate-100 dark:bg-dark-800 text-slate-600 dark:text-slate-300">Cancel</button>
                <button id="confirmDeleteBtn" class="flex-1 px-4 py-2.5 rounded-lg font-bold text-sm bg-rose-600 text-white">Delete</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="fixed bottom-8 left-1/2 -translate-x-1/2 z-[100] transform transition-all duration-500 translate-y-20 opacity-0">
        <div class="bg-white dark:bg-dark-800 border border-slate-200 dark:border-dark-700 px-6 py-3 rounded-xl shadow-2xl flex items-center gap-3">
            <div id="toastIcon"></div>
            <span id="toastMessage" class="text-sm font-bold text-slate-700 dark:text-slate-200 tracking-tight"></span>
        </div>
    </div>

    <script type="module" src="js/app.js"></script>
</body>
</html>
